{% extends "base.html" %}

{% block content %}
<div class="max-w-2xl mx-auto text-center">
    <div
        class="bg-green-100 text-green-700 w-20 h-20 rounded-full flex items-center justify-center mx-auto mb-6 scale-110 shadow-lg border-4 border-white">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
        </svg>
    </div>

    <h1 class="text-4xl font-bold mb-2">Pedido Recebido!</h1>
    <p class="text-slate-500 mb-10 text-lg">Seu pedido #{{ order.id[:8] }} está aguardando o Pix.</p>

    <div class="glass p-8 rounded-[3rem] shadow-2xl mb-8 relative overflow-hidden">
        <div class="absolute -top-12 -right-12 w-32 h-32 bg-indigo-100 rounded-full opacity-50"></div>

        <h3 class="font-bold text-xl mb-6 flex items-center justify-center gap-2">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-indigo-600" fill="none" viewBox="0 0 24 24"
                stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                    d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            Pagamento via Pix
        </h3>

        <div class="bg-white p-6 rounded-3xl inline-block shadow-inner mb-6 border-2 border-indigo-50">
            <img src="data:image/png;base64,{{ qr_code }}" class="w-64 h-64 grayscale-0 contrast-125">
        </div>

        <div class="space-y-4">
            <div class="text-3xl font-black text-slate-800">
                R$ {{ "%.2f"|format(order.total) }}
            </div>

            <div class="bg-slate-100 p-4 rounded-2xl break-all text-xs font-mono text-slate-600 relative group">
                {{ payload }}
                <button onclick="copyPayload()"
                    class="absolute right-2 top-2 bg-white p-2 rounded-lg shadow hover:bg-slate-50">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24"
                        stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <div class="space-y-6">
        <a href="https://wa.me/{{ order.stores.whatsapp }}?text=Olá, acabei de fazer o pedido #{{ order.id[:8] }} e o pagamento do Pix."
            class="inline-flex items-center gap-3 text-primary font-bold hover:underline">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24">
                <path
                    d="M.057 24l1.687-6.163c-1.041-1.804-1.588-3.849-1.587-5.946.003-6.556 5.338-11.891 11.893-11.891 3.181.001 6.167 1.24 8.413 3.488 2.245 2.248 3.481 5.236 3.48 8.414-.003 6.557-5.338 11.892-11.893 11.892-1.99-.001-3.951-.5-5.688-1.448l-6.305 1.654zm6.597-3.807c1.676.995 3.276 1.591 5.319 1.592 5.548 0 10.064-4.516 10.066-10.066.003-5.385-4.482-9.766-9.844-9.766-5.412 0-9.819 4.407-9.822 9.819 0 2.153.603 3.513 1.627 5.28l-1.071 3.909 4.025-1.056z" />
            </svg>
            Enviar Comprovante via WhatsApp
        </a>
        <p class="text-sm text-slate-400">Assim que você pagar, o motoboy da Uber será chamado automaticamente.</p>
    </div>
</div>

<script>
    function copyPayload ()
    {
        const payload = "{{ payload }}";
        navigator.clipboard.writeText( payload );
        alert( "Pix Copia e Cola copiado!" );
    }
</script>
{% endblock %}
